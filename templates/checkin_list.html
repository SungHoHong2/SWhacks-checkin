<title>checkin-service</title>

<script src="/templates/js/jquery.js" type="text/javascript"></script>
<script src="/templates/js/jquery-ui-custom.min.js" type="text/javascript"></script>
<script src="/templates/js/jquery.layout.js" type="text/javascript"></script>
<script src="/templates/js/grid.locale-en.js" type="text/javascript"></script>
<script src="/templates/js/ui.multiselect.js" type="text/javascript"></script>
<script src="/templates/js/jquery.jqGrid.js" type="text/javascript"></script>


<link rel="stylesheet" type="text/css" media="screen" href="/templates/css/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" media="screen" href="/templates/css/ui.jqgrid.css">
<link rel="stylesheet" type="text/css" media="screen" href="/templates/css/ui.multiselect.css">
<link rel="stylesheet" type="text/css" media="screen" href="/templates/css/checkin.css">


<script type="text/javascript">

$(document).ready(function() {
    var checkin_grid;
    var attendant_list = {
        page : 1, total: 2, records: 10,
        rows : {{ attendant_list|safe }}
    };

    $("#checkin_list").jqGrid({
            datatype: 'jsonstring',
            datastr: attendant_list,
            colNames:['id','first_name', 'last_name', 'email','dietary preferences','special accomodations','present'],
            colModel:[
                {name:'id', hidden: true},
                {name:'first_name', index: 'first_name'},
                {name:'last_name'},
                {name:'email'},
                {name:'dietary_preferences', width: 200},
                {name:'special_accomodations', width : 200},
                {name:'present'}
            ],
            onSelectRow: function(ids) {

                var obj = checkin_grid.getRowData(ids);
                var sendObj = {};
                    sendObj.id = ids;

                console.log(obj.present);
                console.log(typeof obj.present);


                if(obj.present=='true'){
                    sendObj.is_present = true;
                }

                $.ajax({
                    url : '../update',
                    type: "POST",
                    data : sendObj,
                    success: function(data, textStatus, jqXHR){
                        console.log(data);
                    },
                    error: function (jqXHR, textStatus, errorThrown){
                 
                    }
                });
            },
            rowNum:10,
            rowList:[10,20,30],
            pager: '#pager2',
            sortname: 'id',
            sortorder: "desc",
            multiselect : true,
            caption : '-'
    });

    checkin_grid = $("#checkin_list").jqGrid('navGrid','#pager2',{edit:false,add:false,del:false});
    $('.ui-jqgrid-title').empty().append($('<a/>').text('Logout').attr('href','{{ logout_url }}'));
});


</script>
</head>

<body>
<table id="checkin_list"></table>
<div id="pager2"></div>
</body>

